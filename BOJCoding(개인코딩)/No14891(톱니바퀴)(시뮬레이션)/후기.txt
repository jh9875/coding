처음엔 문제를 제대로 읽지 않아서 잘못풀었고,
나중엔 약간의 실수로 계속 틀렸다.

왜 안되는지 몰랐는데 구조체를 잘못 설계해서 계속 틀렸었다.

그래도 하나씩 출력해보니까 잘못된 부분을 찾을 수 있었다.